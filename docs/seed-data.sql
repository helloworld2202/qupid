-- Qupid Seed Data
-- ì´ˆê¸° ë°ì´í„° ì‹œë”© ìŠ¤í¬ë¦½íŠ¸

-- =====================================================
-- 1. AI PERSONAS (í˜ë¥´ì†Œë‚˜ ë°ì´í„°)
-- =====================================================

INSERT INTO public.personas (id, name, gender, age, mbti, personality, occupation, bio, interests, avatar, match_rate, difficulty, tags) VALUES
('persona-1', 'ê¹€ì†Œì—°', 'female', 25, 'ENFJ', 'ë°ê³  í™œë°œí•œ', 'ë§ˆì¼€íŒ… ë§¤ë‹ˆì €', 
 'í•­ìƒ ê¸ì •ì ì¸ ì—ë„ˆì§€ë¥¼ ê°€ì§€ê³  ìˆì–´ìš”! ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•˜ëŠ” ê±¸ ì¢‹ì•„í•˜ê³ , íŠ¹íˆ ë§›ì§‘ íƒë°©ì´ë‚˜ ì—¬í–‰ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ëŠ” ê±¸ ì¦ê²¨ìš”.',
 ARRAY['ë§›ì§‘ íƒë°©', 'ì—¬í–‰', 'ìš”ê°€', 'ë…ì„œ'],
 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400',
 85, 'Easy', ARRAY['ì¹œê·¼í•¨', 'ê¸ì •ì ', 'ëŒ€í™” ì£¼ë„']),

('persona-2', 'ì´ì§€ì€', 'female', 28, 'ISFJ', 'ì°¨ë¶„í•˜ê³  ë”°ëœ»í•œ', 'ì´ˆë“±í•™êµ êµì‚¬',
 'ì•„ì´ë“¤ì„ ê°€ë¥´ì¹˜ëŠ” ì¼ì„ í•˜ê³  ìˆì–´ìš”. ì¡°ìš©í•œ ì¹´í˜ì—ì„œ ì±… ì½ëŠ” ê±¸ ì¢‹ì•„í•˜ê³ , ì£¼ë§ì—” ë² ì´í‚¹ì„ ì¦ê²¨í•´ìš”.',
 ARRAY['ë…ì„œ', 'ë² ì´í‚¹', 'ì¹´í˜ íˆ¬ì–´', 'í´ë˜ì‹ ìŒì•…'],
 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=400',
 72, 'Medium', ARRAY['ë”°ëœ»í•¨', 'ê²½ì²­', 'ê³µê°']),

('persona-3', 'ë°•ì„œìœ¤', 'female', 26, 'ENTP', 'ì§€ì ì´ê³  í˜¸ê¸°ì‹¬ ë§ì€', 'UX ë””ìì´ë„ˆ',
 'ë””ìì¸ê³¼ ê¸°ìˆ ì„ ì‚¬ë‘í•˜ëŠ” ë””ìì´ë„ˆì˜ˆìš”. ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ìƒê°í•˜ê³  í† ë¡ í•˜ëŠ” ê±¸ ì¢‹ì•„í•´ìš”.',
 ARRAY['ë””ìì¸', 'ìŠ¤íƒ€íŠ¸ì—…', 'í…Œí¬', 'ì˜í™”'],
 'https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=400',
 78, 'Hard', ARRAY['ì°½ì˜ì ', 'ë…¼ë¦¬ì ', 'ë„ì „ì ']),

('persona-4', 'ìµœí•˜ëŠ˜', 'female', 24, 'ISFP', 'ê°ì„±ì ì´ê³  ì˜ˆìˆ ì ì¸', 'ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´í„°',
 'ê·¸ë¦¼ ê·¸ë¦¬ëŠ” ê±¸ ì¢‹ì•„í•˜ëŠ” í”„ë¦¬ëœì„œ ì¼ëŸ¬ìŠ¤íŠ¸ë ˆì´í„°ì˜ˆìš”. ì¡°ìš©í•˜ì§€ë§Œ ê¹Šì€ ëŒ€í™”ë¥¼ ì¦ê²¨ìš”.',
 ARRAY['ê·¸ë¦¼', 'ì „ì‹œíšŒ', 'ì¸ë””ìŒì•…', 'ì‚¬ì§„'],
 'https://images.unsplash.com/photo-1517841905240-472988babdf9?w=400',
 65, 'Medium', ARRAY['ì˜ˆìˆ ì ', 'ì„¬ì„¸í•¨', 'ì§„ì†”í•¨']),

('persona-5', 'ì •ë¯¼ì§€', 'female', 27, 'ESTJ', 'ìì‹ ê° ìˆê³  ì£¼ë„ì ì¸', 'ë³€í˜¸ì‚¬',
 'ì¼ì— ëŒ€í•œ ì—´ì •ì´ ë„˜ì¹˜ëŠ” ë³€í˜¸ì‚¬ì˜ˆìš”. ìš´ë™ì„ ì¢‹ì•„í•˜ê³  ëª©í‘œ ì§€í–¥ì ì¸ ì„±ê²©ì´ì—ìš”.',
 ARRAY['í”¼íŠ¸ë‹ˆìŠ¤', 'ì™€ì¸', 'ê²½ì œ', 'ìê¸°ê³„ë°œ'],
 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=400',
 70, 'Hard', ARRAY['ë¦¬ë”ì‹­', 'ëª©í‘œì§€í–¥', 'ì§ì„¤ì ']),

-- ë‚¨ì„± í˜ë¥´ì†Œë‚˜ ì¶”ê°€
('persona-6', 'ê°•ì¤€í˜¸', 'male', 29, 'INTJ', 'ë¶„ì„ì ì´ê³  ì „ëµì ì¸', 'ì†Œí”„íŠ¸ì›¨ì–´ ì—”ì§€ë‹ˆì–´',
 'ê¸°ìˆ ê³¼ í˜ì‹ ì„ ì¢‹ì•„í•˜ëŠ” ê°œë°œìì…ë‹ˆë‹¤. ë³µì¡í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤.',
 ARRAY['í”„ë¡œê·¸ë˜ë°', 'ì²´ìŠ¤', 'SFì†Œì„¤', 'í•˜ì´í‚¹'],
 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400',
 75, 'Hard', ARRAY['ë…¼ë¦¬ì ', 'ì „ëµì ', 'ë…ë¦½ì ']),

('persona-7', 'ì´ë„í˜„', 'male', 26, 'ESFP', 'ìœ ë¨¸ëŸ¬ìŠ¤í•˜ê³  ì‚¬êµì ì¸', 'ê´‘ê³  PD',
 'ì¬ë¯¸ìˆëŠ” ê²ƒì„ ì¢‹ì•„í•˜ê³  ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. íŒŒí‹°ì˜ ë¶„ìœ„ê¸° ë©”ì´ì»¤ì˜ˆìš”!',
 ARRAY['íŒŒí‹°', 'ìŒì•…', 'ìŠ¤í¬ì¸ ', 'ê²Œì„'],
 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=400',
 80, 'Easy', ARRAY['ìœ ë¨¸', 'ì‚¬êµì ', 'ì¦‰í¥ì ']),

('persona-8', 'ë°•ì„œì¤€', 'male', 31, 'INFP', 'ë¡œë§¨í‹±í•˜ê³  ì´ìƒì£¼ì˜ì ì¸', 'ì‘ê°€',
 'ê°ì„±ì ì¸ ê¸€ì„ ì“°ëŠ” ì‘ê°€ì…ë‹ˆë‹¤. ê¹Šì€ ëŒ€í™”ì™€ ì˜ë¯¸ ìˆëŠ” ê´€ê³„ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.',
 ARRAY['ë¬¸í•™', 'ì˜í™”', 'ì»¤í”¼', 'ì—¬í–‰'],
 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400',
 68, 'Medium', ARRAY['ë¡œë§¨í‹±', 'ì°½ì˜ì ', 'ê³µê°ëŠ¥ë ¥']);

-- =====================================================
-- 2. AI COACHES (ì½”ì¹˜ ë°ì´í„°)
-- =====================================================

INSERT INTO public.coaches (id, name, specialty, tagline, bio, avatar, expertise_areas, coaching_style) VALUES
('coach-1', 'ë¯¼ì„œ', 'ê³µê°ë ¥', 'ìƒëŒ€ë°©ì˜ ë§ˆìŒì„ ì½ëŠ” ê³µê° ì „ë¬¸ê°€',
 '10ë…„ê°„ ì‹¬ë¦¬ìƒë‹´ì‚¬ë¡œ ì¼í•˜ë©° ìˆ˜ë§ì€ ì—°ì•  ìƒë‹´ì„ ì§„í–‰í–ˆì–´ìš”. ìƒëŒ€ë°©ì˜ ê°ì •ì„ ì´í•´í•˜ê³  ê³µê°í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ë“œë¦´ê²Œìš”.',
 'https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?w=400',
 ARRAY['ê°ì • ì½ê¸°', 'ê³µê° í‘œí˜„', 'ê²½ì²­ ìŠ¤í‚¬'],
 'ë”°ëœ»í•˜ê³  ì´í•´ì‹¬ ë§ì€ ìƒë‹´ ìŠ¤íƒ€ì¼'),

('coach-2', 'ì¤€ì˜', 'ëŒ€í™” ìŠ¤í‚¬', 'ìì—°ìŠ¤ëŸ¬ìš´ ëŒ€í™”ë¥¼ ì´ë„ëŠ” ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì „ë¬¸ê°€',
 'ë°©ì†¡ì‘ê°€ ì¶œì‹ ìœ¼ë¡œ ìŠ¤í† ë¦¬í…”ë§ê³¼ ëŒ€í™” ê¸°ìˆ ì— ì „ë¬¸ì„±ì„ ê°€ì§€ê³  ìˆì–´ìš”. ì–´ìƒ‰í•œ ì¹¨ë¬µ ì—†ì´ ëŒ€í™”ë¥¼ ì´ì–´ê°€ëŠ” ë¹„ë²•ì„ ì „ìˆ˜í•´ë“œë ¤ìš”.',
 'https://images.unsplash.com/photo-1560250097-0b93528c311a?w=400',
 ARRAY['ëŒ€í™” ì‹œì‘', 'ì£¼ì œ ì „í™˜', 'ìŠ¤í† ë¦¬í…”ë§'],
 'ì‹¤ìš©ì ì´ê³  ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ íŒ ì œê³µ'),

('coach-3', 'í•˜ì€', 'ë§¤ë ¥ ì–´í•„', 'ìì‹ ì˜ ë§¤ë ¥ì„ 200% ë°œì‚°í•˜ëŠ” ë°©ë²•',
 'ì´ë¯¸ì§€ ì»¨ì„¤í„´íŠ¸ë¡œ í™œë™í•˜ë©° ë§ì€ ì‚¬ëŒë“¤ì˜ ìˆ¨ê²¨ì§„ ë§¤ë ¥ì„ ì°¾ì•„ë“œë ¸ì–´ìš”. ë‹¹ì‹ ë§Œì˜ íŠ¹ë³„í•œ ë§¤ë ¥ í¬ì¸íŠ¸ë¥¼ ë°œê²¬í•˜ê³  ì–´í•„í•˜ëŠ” ë°©ë²•ì„ ì½”ì¹­í•´ë“œë ¤ìš”.',
 'https://images.unsplash.com/photo-1594744803329-e58b31de8bf5?w=400',
 ARRAY['ì²«ì¸ìƒ ê´€ë¦¬', 'ë§¤ë ¥ í¬ì¸íŠ¸ ë°œêµ´', 'ìì‹ ê° í–¥ìƒ'],
 'ê¸ì •ì ì´ê³  ë™ê¸°ë¶€ì—¬ê°€ ë˜ëŠ” ì½”ì¹­');

-- =====================================================
-- 3. BADGES (ë±ƒì§€ ì •ì˜)
-- =====================================================

INSERT INTO public.badges (id, name, icon, description, category, rarity, requirement_type, requirement_value) VALUES
('badge-1', 'ëŒ€í™” ì´ˆë³´ì', 'ğŸŒ±', 'ì²« ëŒ€í™” ì™„ë£Œ', 'ëŒ€í™”', 'Common', 'conversations', 1),
('badge-2', 'ëŒ€í™” ì¤‘ê¸‰ì', 'ğŸŒ¿', '10íšŒ ëŒ€í™” ì™„ë£Œ', 'ëŒ€í™”', 'Common', 'conversations', 10),
('badge-3', 'ëŒ€í™” ë§ˆìŠ¤í„°', 'ğŸŒ³', '50íšŒ ëŒ€í™” ì™„ë£Œ', 'ëŒ€í™”', 'Rare', 'conversations', 50),
('badge-4', 'í˜¸ê°ë„ ë§ˆìŠ¤í„°', 'ğŸ’–', 'í˜¸ê°ë„ 80% ë‹¬ì„±', 'ì„±ê³¼', 'Rare', 'affinity_score', 80),
('badge-5', 'ì—°ì† ëŒ€í™”ì™•', 'ğŸ”¥', '7ì¼ ì—°ì† ëŒ€í™”', 'ì„±ì¥', 'Epic', 'streak_days', 7),
('badge-6', 'ì™„ë²½ì£¼ì˜ì', 'ğŸ’¯', 'ë¶„ì„ ì ìˆ˜ 100ì  ë‹¬ì„±', 'ì„±ê³¼', 'Epic', 'perfect_score', 100),
('badge-7', 'íƒí—˜ê°€', 'ğŸ—ºï¸', 'ëª¨ë“  í˜ë¥´ì†Œë‚˜ì™€ ëŒ€í™”', 'íƒí—˜', 'Legendary', 'all_personas', 1),
('badge-8', 'ì„±ì¥ì™•', 'ğŸ“ˆ', 'ì£¼ê°„ ì„±ì¥ë¥  50% ì´ìƒ', 'ì„±ì¥', 'Rare', 'weekly_growth', 50),
('badge-9', 'ì¸ê¸°ìŠ¤íƒ€', 'â­', '5ëª… ì´ìƒ ì¦ê²¨ì°¾ê¸°', 'ì†Œì…œ', 'Common', 'favorites', 5),
('badge-10', 'í•™ìŠµì™•', 'ğŸ“', 'ëª¨ë“  ì½”ì¹˜ì™€ ìƒë‹´ ì™„ë£Œ', 'í•™ìŠµ', 'Epic', 'all_coaches', 1);

-- =====================================================
-- 4. í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì (ê°œë°œìš©)
-- =====================================================

-- í…ŒìŠ¤íŠ¸ìš© ê¸°ë³¸ ì‚¬ìš©ì ë°ì´í„°
-- UUIDëŠ” Supabaseê°€ ìë™ ìƒì„±í•˜ë„ë¡ gen_random_uuid() ì‚¬ìš©
INSERT INTO public.users (id, name, user_gender, partner_gender, experience, confidence, difficulty, interests, is_tutorial_completed)
VALUES 
-- ë‚¨ì„± í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì (ì—¬ì„± AIì™€ ëŒ€í™”)
('test-user-1', 'ê¹€ë¯¼ìˆ˜', 'male', 'female', '1-2ë²ˆ ì •ë„', 3, 2, 
 ARRAY['ê²Œì„', 'ì˜í™”', 'ìŒì•…', 'ìš´ë™'], true),
 
-- ì—¬ì„± í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì (ë‚¨ì„± AIì™€ ëŒ€í™”) 
('test-user-2', 'ì´ìˆ˜ì§„', 'female', 'male', 'ëª‡ ë²ˆ ìˆì–´ìš”', 4, 3,
 ARRAY['ì—¬í–‰', 'ìš”ë¦¬', 'ë…ì„œ', 'ìš”ê°€'], true),

-- íŠœí† ë¦¬ì–¼ ë¯¸ì™„ë£Œ ì‚¬ìš©ì
('test-user-3', 'ë°•ì¤€ì˜', 'male', 'female', 'ì „í˜€ ì—†ì–´ìš”', 2, 1,
 ARRAY['ê²Œì„', 'ì• ë‹ˆë©”ì´ì…˜'], false);

-- =====================================================
-- 5. ìƒ˜í”Œ ì„±ê³¼ ë°ì´í„° (í…ŒìŠ¤íŠ¸ìš©)
-- =====================================================

-- í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìì˜ ì„±ê³¼ ë°ì´í„°
INSERT INTO public.performance_metrics (user_id, week_start, weekly_score, daily_scores, category_scores, total_time_minutes, session_count)
VALUES 
-- ê¹€ë¯¼ìˆ˜ì˜ ì´ë²ˆ ì£¼ ì„±ê³¼
('test-user-1', date_trunc('week', CURRENT_DATE)::date, 78, ARRAY[60, 65, 70, 68, 75, 72, 78],
 '{"ì¹œê·¼í•¨": 85, "í˜¸ê¸°ì‹¬": 92, "ê³µê°ë ¥": 58, "ìœ ë¨¸": 60, "ë°°ë ¤": 75, "ì ê·¹ì„±": 70}'::jsonb,
 135, 8),
 
-- ê¹€ë¯¼ìˆ˜ì˜ ì§€ë‚œ ì£¼ ì„±ê³¼
('test-user-1', date_trunc('week', CURRENT_DATE - INTERVAL '7 days')::date, 65, ARRAY[55, 58, 60, 62, 65, 63, 65],
 '{"ì¹œê·¼í•¨": 72, "í˜¸ê¸°ì‹¬": 78, "ê³µê°ë ¥": 45, "ìœ ë¨¸": 52, "ë°°ë ¤": 68, "ì ê·¹ì„±": 60}'::jsonb,
 95, 6),

-- ì´ìˆ˜ì§„ì˜ ì´ë²ˆ ì£¼ ì„±ê³¼
('test-user-2', date_trunc('week', CURRENT_DATE)::date, 85, ARRAY[75, 78, 80, 82, 85, 83, 85],
 '{"ì¹œê·¼í•¨": 90, "í˜¸ê¸°ì‹¬": 88, "ê³µê°ë ¥": 82, "ìœ ë¨¸": 75, "ë°°ë ¤": 88, "ì ê·¹ì„±": 80}'::jsonb,
 180, 10);

-- =====================================================
-- 6. í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ë±ƒì§€ ë° ì¦ê²¨ì°¾ê¸°
-- =====================================================

-- ê¹€ë¯¼ìˆ˜ì˜ ë±ƒì§€
INSERT INTO public.user_badges (user_id, badge_id, progress_current, progress_total, featured)
VALUES 
('test-user-1', 'badge-1', 1, 1, false),  -- ëŒ€í™” ì´ˆë³´ì (íšë“)
('test-user-1', 'badge-2', 8, 10, true),   -- ëŒ€í™” ì¤‘ê¸‰ì (ì§„í–‰ì¤‘, ëŒ€í‘œ ë±ƒì§€)
('test-user-1', 'badge-4', 78, 80, false), -- í˜¸ê°ë„ ë§ˆìŠ¤í„° (ì§„í–‰ì¤‘)
('test-user-1', 'badge-5', 3, 7, false);   -- ì—°ì† ëŒ€í™”ì™• (ì§„í–‰ì¤‘)

-- ì´ìˆ˜ì§„ì˜ ë±ƒì§€  
INSERT INTO public.user_badges (user_id, badge_id, progress_current, progress_total, featured)
VALUES
('test-user-2', 'badge-1', 1, 1, false),   -- ëŒ€í™” ì´ˆë³´ì (íšë“)
('test-user-2', 'badge-2', 10, 10, false), -- ëŒ€í™” ì¤‘ê¸‰ì (íšë“)
('test-user-2', 'badge-4', 85, 80, true),  -- í˜¸ê°ë„ ë§ˆìŠ¤í„° (íšë“, ëŒ€í‘œ ë±ƒì§€)
('test-user-2', 'badge-8', 30, 50, false); -- ì„±ì¥ì™• (ì§„í–‰ì¤‘)

-- ê¹€ë¯¼ìˆ˜ì˜ ì¦ê²¨ì°¾ê¸°
INSERT INTO public.favorites (user_id, persona_id)
VALUES 
('test-user-1', 'persona-1'),  -- ê¹€ì†Œì—°
('test-user-1', 'persona-3');  -- ë°•ì„œìœ¤

-- ì´ìˆ˜ì§„ì˜ ì¦ê²¨ì°¾ê¸°
INSERT INTO public.favorites (user_id, persona_id)
VALUES
('test-user-2', 'persona-6'),  -- ê°•ì¤€í˜¸
('test-user-2', 'persona-7'),  -- ì´ë„í˜„
('test-user-2', 'persona-8');  -- ë°•ì„œì¤€

-- =====================================================
-- 7. í…ŒìŠ¤íŠ¸ ëŒ€í™” ê¸°ë¡
-- =====================================================

-- ê¹€ë¯¼ìˆ˜ì˜ ìµœê·¼ ëŒ€í™”
INSERT INTO public.conversations (id, user_id, partner_type, partner_id, is_tutorial, status)
VALUES
('conv-1', 'test-user-1', 'persona', 'persona-1', false, 'completed'),
('conv-2', 'test-user-1', 'persona', 'persona-3', false, 'active'),
('conv-3', 'test-user-1', 'coach', 'coach-1', false, 'completed');

-- ëŒ€í™” ë©”ì‹œì§€ ìƒ˜í”Œ
INSERT INTO public.messages (conversation_id, sender_type, content)
VALUES
('conv-1', 'user', 'ì•ˆë…•í•˜ì„¸ìš”! ì²˜ìŒ ëµ™ê² ìŠµë‹ˆë‹¤.'),
('conv-1', 'ai', 'ì•ˆë…•í•˜ì„¸ìš”! ë§Œë‚˜ì„œ ë°˜ê°€ì›Œìš” ğŸ˜Š ì €ëŠ” ì†Œì—°ì´ì—ìš”. ë§ˆì¼€íŒ… ì¼ì„ í•˜ê³  ìˆì–´ìš”.'),
('conv-1', 'user', 'ì˜¤, ë§ˆì¼€íŒ…ì´ìš”? ì¬ë¯¸ìˆìœ¼ì‹¤ ê²ƒ ê°™ì•„ìš”!'),
('conv-1', 'ai', 'ë„¤, ì •ë§ ì¬ë¯¸ìˆì–´ìš”! íŠ¹íˆ ì‚¬ëŒë“¤ì˜ ë§ˆìŒì„ ì›€ì§ì´ëŠ” ìº í˜ì¸ì„ ë§Œë“¤ ë•Œ ë³´ëŒì„ ëŠê»´ìš”. í˜¹ì‹œ ì–´ë–¤ ì¼ í•˜ì„¸ìš”?');

-- ëŒ€í™” ë¶„ì„ ê²°ê³¼
INSERT INTO public.conversation_analysis (conversation_id, overall_score, affinity_score, improvements, achievements, tips)
VALUES
('conv-1', 75, 78, 
 ARRAY['ë” êµ¬ì²´ì ì¸ ì§ˆë¬¸í•˜ê¸°', 'ê°ì • í‘œí˜„ ëŠ˜ë¦¬ê¸°'],
 ARRAY['ìì—°ìŠ¤ëŸ¬ìš´ ì¸ì‚¬', 'ì ì ˆí•œ ë¦¬ì•¡ì…˜'],
 ARRAY['ìƒëŒ€ë°©ì˜ ê´€ì‹¬ì‚¬ì— ëŒ€í•´ ë” ê¹Šì´ ë¬¼ì–´ë³´ì„¸ìš”', 'ìì‹ ì˜ ê²½í—˜ì„ ê³µìœ í•˜ë©´ ëŒ€í™”ê°€ í’ì„±í•´ì ¸ìš”']);

-- =====================================================
-- 8. ê¸°ë³¸ ì„¤ì •ê°’
-- =====================================================

-- ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ê¸°ë³¸ ì•Œë¦¼ ì„¤ì •ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ë„ë¡ í•˜ëŠ” í•¨ìˆ˜
CREATE OR REPLACE FUNCTION create_default_notification_settings()
RETURNS TRIGGER AS $$
BEGIN
    INSERT INTO public.notification_settings (user_id)
    VALUES (NEW.id)
    ON CONFLICT (user_id) DO NOTHING;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER create_user_notification_settings
AFTER INSERT ON public.users
FOR EACH ROW EXECUTE FUNCTION create_default_notification_settings();

-- =====================================================
-- 7. ì„±ê³¼ ë°ì´í„° ìë™ ìƒì„± í•¨ìˆ˜
-- =====================================================

-- ìƒˆë¡œìš´ ì£¼ì˜ ì„±ê³¼ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±
CREATE OR REPLACE FUNCTION create_weekly_performance_metrics()
RETURNS void AS $$
DECLARE
    user_record RECORD;
    current_week_start DATE := date_trunc('week', CURRENT_DATE)::date;
BEGIN
    FOR user_record IN SELECT id FROM public.users
    LOOP
        INSERT INTO public.performance_metrics (user_id, week_start, daily_scores)
        VALUES (user_record.id, current_week_start, ARRAY[0,0,0,0,0,0,0])
        ON CONFLICT (user_id, week_start) DO NOTHING;
    END LOOP;
END;
$$ LANGUAGE plpgsql;

-- ë§¤ì£¼ ì›”ìš”ì¼ì— ì‹¤í–‰ë˜ë„ë¡ ìŠ¤ì¼€ì¤„ë§ (Supabase Cron Jobìœ¼ë¡œ ì„¤ì • í•„ìš”)
-- SELECT cron.schedule('weekly-performance-metrics', '0 0 * * 1', 'SELECT create_weekly_performance_metrics();');